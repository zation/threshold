"use strict";angular.module("logicMonitorApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngCollection"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/threshold.html",controller:"ThresholdCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("logicMonitorApp").controller("ThresholdCtrl",["$scope","Thresholds","Threshold",function(a,b,c){a.thresholds=b.getInstance(),a.thresholds.addA(new c({from:"",until:"",operator:">",numberForWarning:"",numberForError:22,numberForCritical:0})),a.thresholds.addA(new c({from:"22:00",until:"02:00",operator:">",numberForWarning:"",numberForError:22,numberForCritical:0})),a.thresholds.addA(new c({from:"00:30",until:"01:30",operator:"=",numberForWarning:11,numberForError:"",numberForCritical:0})),a.thresholds.addA(new c({from:"03:30",until:"04:30",operator:"<",numberForWarning:11,numberForError:12312,numberForCritical:0})),a.$on("activate",function(b,c){a.$broadcast("deactivate",c)}),a.onAdd=function(b){a.thresholds.addA(b)},a.onRemove=function(b){a.thresholds.remove(b)},a.fromOrder=function(a){return a.from?Number(a.from.replace(":",".")):24}}]),angular.module("logicMonitorApp").factory("Thresholds",["$collection",function(a){var b=a,c=["purple","light-blue","green","blue","magenta"];b.TIMES=[];for(var d=0;24>d;d++)for(var e=0;60>e;e+=15){var f=10>d?"0"+d:d,g=10>e?"0"+e:e;b.TIMES.push(f+":"+g)}return b.COMPARISONS=[{name:"is equal to (=)",operator:"="},{name:"is greater than (>)",operator:">"},{name:"is less than (<)",operator:"<"}],b.prototype.addA=function(a){var b=this.array.length%c.length;a.color=c[b],this.add(a)},b}]),angular.module("logicMonitorApp").factory("Threshold",function(){var a=function(a){angular.copy(a,this)};return a.prototype.isAllDay=function(){return""===this.from||null===this.from||void 0===this.from},a.prototype.copyDataTo=function(a){a.color=this.color,a.from=this.from,a.until=this.until,a.operator=this.operator,a.numberForWarning=this.numberForWarning,a.numberForError=this.numberForError,a.numberForCritical=this.numberForCritical},a}),angular.module("logicMonitorApp").directive("lmThresholdEditor",["$document",function(a){return{restrict:"EA",templateUrl:"views/thresholdEditor.html",replace:!0,scope:{onSave:"=",onRemove:"=",threshold:"="},link:function(b,c){angular.element(c).on("click",function(a){a.stopPropagation();var b=["INPUT","LABEL","SELECT"];b.indexOf(a.target.nodeName)<0&&angular.element(c).find(".from").focus()}),a.on("click",function(a){b.active&&b.$apply(function(){b.cancel(a)})}),a.on("keyup",function(a){27===a.keyCode&&(angular.element(c).find("input, select").blur(),b.$apply(function(){b.cancel(a)}))})},controller:["$scope","Thresholds","Threshold",function(a,b,c){function d(){a.newThreshold=new c({id:"new",from:"",until:a.times[0],operator:a.comparisons[0].operator})}a.times=b.TIMES,a.comparisons=b.COMPARISONS,a.isAdding=void 0===a.threshold,a.isEditing=!a.isAdding,a.isAdding?d():(a.newThreshold=new c,a.threshold.copyDataTo(a.newThreshold)),a.active=!1,a.activate=function(){a.active=!0,a.$emit("activate",a.newThreshold.id)},a.$on("deactivate",function(b,c){c!==a.newThreshold.id&&(a.active=!1)}),a.remove=function(b){b.stopPropagation(),a.onRemove&&a.onRemove(a.threshold)},a.cancel=function(b){b.stopPropagation(),a.active=!1,a.isAdding?d():a.threshold.copyDataTo(a.newThreshold)},a.submit=function(b){b.stopPropagation(),a.active=!1,a.isAdding?(delete a.newThreshold.id,a.onSave(a.newThreshold),d()):a.isEditing&&a.newThreshold.copyDataTo(a.threshold)}}]}}]),angular.module("logicMonitorApp").directive("lmTimeSpam",function(){return{restrict:"EA",templateUrl:"views/timeSpam.html",scope:{threshold:"="},link:function(a,b){a.$watchCollection("[threshold.from, threshold.until]",function(){if(!a.threshold.isAllDay()){var c=1166,d=Number(a.threshold.from.replace(":",".")),e=Number(a.threshold.until.replace(":",".")),f=angular.element(b).find(".spam");a.isCrossDay=d>e,a.isCrossDay?(f.eq(0).css({left:0,width:e/24*c}),f.eq(1).css({left:d/24*c,right:0})):f.css({left:d/24*c,width:(e-d)/24*c})}})}}});